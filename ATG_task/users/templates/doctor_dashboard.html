{% extends 'base.html' %}
{% load static %}
{% block content %}

<h2>Welcome, {{ user.first_name }} {{ user.last_name }}</h2>
<p>User Type: {{ user.user_type }}</p>
<p>Email: {{ user.email }}</p>
<p>Address: {{ user.address_line1 }}, {{ user.city }}, {{ user.state }} - {{ user.pincode }}</p>
{% if user.profile_picture %}
    <img src="{{ user.profile_picture.url }}" width="150" class="img-thumbnail" />
{% endif %}

<hr>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Your Blog Posts</h3>
    <a href="{% url 'create_blog' %}" class="btn btn-primary">Create New Post</a>
</div>
<form method="get" class="mb-4">
    <label for="category">Filter by Category:</label>
    <select name="category" id="category" class="form-select w-auto d-inline-block ms-2" onchange="this.form.submit()">
        {% for category in categories %}
            <option value="{{ category }}" {% if category == selected_category %}selected{% endif %}>{{ category }}</option>
        {% endfor %}
    </select>
</form>
{% if blogs %}
    <div class="list-group">
        {% for blog in blogs %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <h5>{{ blog.title }}</h5>
                    <small class="text-muted">{{ blog.category }} | {{ blog.created_at|date:"M d, Y" }}</small>
                </div>
                <form method="post" action="{% url 'delete_blog' blog.id %}" onsubmit="return confirm('Are you sure you want to delete this post?');">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                </form>
                 <a href="{% url 'edit_blog' blog.id %}" class="btn btn-secondary btn-sm ms-2">Edit</a>
                 <a href="{% url 'blog_detail' blog.id %}" class="btn btn-outline-primary btn-sm ms-2">View</a>
            </div>
            
        {% endfor %}
    </div>
{% else %}
    <p>You have no blog posts yet.</p>
{% endif %}

{% endblock %}
